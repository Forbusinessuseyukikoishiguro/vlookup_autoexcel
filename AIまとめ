# æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ï¼šVSCodeã§Pythonè‡ªå‹•åŒ–ã‚’å§‹ã‚ã‚ˆã†

## ã¯ã˜ã‚ã«

æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®çš†ã•ã‚“ã€æ‰‹ä½œæ¥­ã§ã®ç¹°ã‚Šè¿”ã—ä½œæ¥­ã«ç–²ã‚Œã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿä»Šå›ã¯ã€VSCodeã¨Pythonã‚’ä½¿ã£ã¦ã€å®Ÿéš›ã®æ¥­å‹™ã§ã‚ˆãã‚ã‚‹Excelã®VLOOKUPä½œæ¥­ã‚’è‡ªå‹•åŒ–ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ã‚‡ã†ã€‚å˜ãªã‚‹ç†è«–ã§ã¯ãªãã€å®Ÿéš›ã«å‹•ããƒ„ãƒ¼ãƒ«ã‚’ä¸€ç·’ã«ä½œã‚ŠãªãŒã‚‰ã€è‡ªå‹•åŒ–ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¦ã„ãã¾ã™ã€‚

## ç›®æ¬¡
1. [ãªãœPythonè‡ªå‹•åŒ–ãªã®ã‹ï¼Ÿ](#ãªãœpythonè‡ªå‹•åŒ–ãªã®ã‹)
2. [VSCodeç’°å¢ƒæ§‹ç¯‰](#vscodeç’°å¢ƒæ§‹ç¯‰)
3. [å®Ÿè·µï¼šExcel VLOOKUPãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚ã†](#å®Ÿè·µ-excel-vlookupãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚ã†)
4. [VSCodeã®ä¾¿åˆ©æ©Ÿèƒ½](#vscodeã®ä¾¿åˆ©æ©Ÿèƒ½)
5. [ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã®ãƒ’ãƒ³ãƒˆ](#ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã®ãƒ’ãƒ³ãƒˆ)

## ãªãœPythonè‡ªå‹•åŒ–ãªã®ã‹ï¼Ÿ

### ğŸ”„ ã“ã‚“ãªä½œæ¥­ã€ã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ
- Excelã§æ¯æ—¥åŒã˜VLOOKUPä½œæ¥­
- CSVãƒ•ã‚¡ã‚¤ãƒ«ã®æ‰‹å‹•æ•´ç†
- ãƒ‡ãƒ¼ã‚¿ã®è»¢è¨˜ãƒ»é›†è¨ˆä½œæ¥­
- ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã®ç¹°ã‚Šè¿”ã—

### âœ¨ è‡ªå‹•åŒ–ã®ãƒ¡ãƒªãƒƒãƒˆ
- **æ™‚é–“ç¯€ç´„**: 5åˆ†ã®ä½œæ¥­ãŒ1ç§’ã«
- **ãƒŸã‚¹å‰Šæ¸›**: äººçš„ã‚¨ãƒ©ãƒ¼ã®æ’²æ»…
- **ä¾¡å€¤å‰µé€ **: å˜ç´”ä½œæ¥­ã‹ã‚‰æˆ¦ç•¥çš„æ¥­å‹™ã¸ã‚·ãƒ•ãƒˆ
- **ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—**: ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦ã®ä¾¡å€¤å‘ä¸Š

## VSCodeç’°å¢ƒæ§‹ç¯‰

### 1. å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢
```bash
# Python 3.8ä»¥ä¸Šã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# https://www.python.org/downloads/

# VSCodeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# https://code.visualstudio.com/
```

### 2. VSCodeæ‹¡å¼µæ©Ÿèƒ½
å¿…é ˆã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ã‚‡ã†ï¼š

```
- Python (Microsoft)
- Pylance (Microsoft)
- Python Debugger (Microsoft)
- autoDocstring - Python Docstring Generator
- Bracket Pair Colorizer 2
```

### 3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
mkdir python-automation
cd python-automation

# ä»®æƒ³ç’°å¢ƒä½œæˆï¼ˆæ¨å¥¨ï¼‰
python -m venv venv

# ä»®æƒ³ç’°å¢ƒæœ‰åŠ¹åŒ–
# Windows
venv\Scripts\activate
# Mac/Linux
source venv/bin/activate

# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pandas openpyxl
```

## å®Ÿè·µï¼šExcel VLOOKUPãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚ã†

### ğŸ¯ ä½œã‚‹ã‚‚ã®ã®æ¦‚è¦
Excelã®VLOOKUPæ©Ÿèƒ½ã‚’Pythonã§è‡ªå‹•åŒ–ã—ã€è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ‹¬å‡¦ç†ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1: åŸºæœ¬ã‚¯ãƒ©ã‚¹ã®è¨­è¨ˆ

```python
#!/usr/bin/env python3
"""
Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã¨ã‚¿ãƒ–åï¼ˆã‚·ãƒ¼ãƒˆåï¼‰ã‚’æŒ‡å®šã—ã¦VLOOKUPã‚’å®Ÿè¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«
"""

import pandas as pd
import os
from datetime import datetime

class ExcelSheetVLOOKUP:
    def __init__(self):
        """åˆæœŸåŒ–ï¼šãƒ‡ãƒ¼ã‚¿æ ¼ç´ç”¨ã®å¤‰æ•°ã‚’æº–å‚™"""
        self.excel1_df = None  # æ¤œç´¢å¯¾è±¡ãƒ‡ãƒ¼ã‚¿
        self.excel2_df = None  # ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿
        self.result_df = None  # çµæœãƒ‡ãƒ¼ã‚¿
```

**æ–°äººå‘ã‘PointğŸ’¡**
- ã‚¯ãƒ©ã‚¹è¨­è¨ˆã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ã¨å‡¦ç†ã‚’ã¾ã¨ã‚ã¦ç®¡ç†
- `__init__`ãƒ¡ã‚½ãƒƒãƒ‰ã§åˆæœŸçŠ¶æ…‹ã‚’å®šç¾©
- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ

### ã‚¹ãƒ†ãƒƒãƒ—2: Excelãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿æ©Ÿèƒ½

```python
def read_excel_sheet(self, file_path, sheet_name):
    """Excelãƒ•ã‚¡ã‚¤ãƒ«ã®æŒ‡å®šã‚·ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã¿"""
    try:
        # ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
        if not os.path.exists(file_path):
            raise FileNotFoundError(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {file_path}")

        # ã‚·ãƒ¼ãƒˆä¸€è¦§å–å¾—
        xl_file = pd.ExcelFile(file_path)
        sheet_names = xl_file.sheet_names
        print(f"åˆ©ç”¨å¯èƒ½ãªã‚·ãƒ¼ãƒˆ: {sheet_names}")

        # ã‚·ãƒ¼ãƒˆåç¢ºèªï¼ˆãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•æ©Ÿèƒ½ï¼‰
        if sheet_name not in sheet_names:
            print(f"è­¦å‘Š: ã‚·ãƒ¼ãƒˆ'{sheet_name}'ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
            sheet_name = sheet_names[0]  # æœ€åˆã®ã‚·ãƒ¼ãƒˆã‚’ä½¿ç”¨
            print(f"ä»£ã‚ã‚Šã«'{sheet_name}'ã‚·ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™")

        # ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        df = pd.read_excel(file_path, sheet_name=sheet_name)
        print(f"èª­ã¿è¾¼ã¿å®Œäº†: {file_path} - {sheet_name}")
        print(f"ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: {df.shape[0]}è¡Œ x {df.shape[1]}åˆ—")
        
        return df

    except Exception as e:
        print(f"èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {e}")
        return None
```

**æ–°äººå‘ã‘PointğŸ’¡**
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§å …ç‰¢æ€§ã‚’ç¢ºä¿
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡ºåŠ›
- ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•æ©Ÿèƒ½ï¼ˆã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã®ä»£æ›¿å‡¦ç†ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—3: å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ç”Ÿæˆ

```python
def generate_output_path(self, excel1_path, suffix="vlookup_result"):
    """å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç”Ÿæˆ"""
    # å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—
    dir_path = os.path.dirname(os.path.abspath(excel1_path))
    base_name = os.path.splitext(os.path.basename(excel1_path))[0]

    # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ããƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆ
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_filename = f"{base_name}_{suffix}_{timestamp}.xlsx"
    output_path = os.path.join(dir_path, output_filename)

    # é‡è¤‡å›é¿ï¼ˆåŒã˜ç§’ã«è¤‡æ•°å®Ÿè¡Œã•ã‚ŒãŸå ´åˆï¼‰
    counter = 1
    while os.path.exists(output_path):
        output_filename = f"{base_name}_{suffix}_{timestamp}_{counter:02d}.xlsx"
        output_path = os.path.join(dir_path, output_filename)
        counter += 1

    return output_path
```

**æ–°äººå‘ã‘PointğŸ’¡**
- ãƒ•ã‚¡ã‚¤ãƒ«åã®é‡è¤‡ã‚’è‡ªå‹•å›é¿
- ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è­˜åˆ¥
- å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ï¼ˆä½¿ã„ã‚„ã™ã•ã‚’è€ƒæ…®ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ¡ã‚¤ãƒ³ã®VLOOKUPå‡¦ç†

```python
def vlookup_with_sheets(self, config):
    """ã‚·ãƒ¼ãƒˆæŒ‡å®šã§VLOOKUPå®Ÿè¡Œ"""
    print("=== Excel VLOOKUP å‡¦ç†é–‹å§‹ ===")

    try:
        # Excel1èª­ã¿è¾¼ã¿ï¼ˆæ¤œç´¢å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ï¼‰
        df1 = self.read_excel_sheet(config["excel1_path"], config["excel1_sheet"])
        if df1 is None:
            return False
        
        # Excel2èª­ã¿è¾¼ã¿ï¼ˆãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼‰
        df2 = self.read_excel_sheet(config["excel2_path"], config["excel2_sheet"])
        if df2 is None:
            return False

        # è¨­å®šå€¤ã®å–å¾—
        search_col = config["search_col"]    # æ¤œç´¢ã‚­ãƒ¼åˆ—
        lookup_col = config["lookup_col"]    # ãƒã‚¹ã‚¿æ¤œç´¢ã‚­ãƒ¼åˆ—
        return_cols = config["return_cols"]  # å–å¾—ã—ãŸã„åˆ—

        # ãƒ‡ãƒ¼ã‚¿å‹ã‚’æ–‡å­—åˆ—ã«çµ±ä¸€ï¼ˆæ¤œç´¢ç²¾åº¦å‘ä¸Šï¼‰
        df1[search_col] = df1[search_col].astype(str)
        df2[lookup_col] = df2[lookup_col].astype(str)

        # ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã®é‡è¤‡å‰Šé™¤
        master_cols = [lookup_col] + return_cols
        df2_filtered = df2[master_cols].copy()
        df2_filtered = df2_filtered.drop_duplicates(subset=[lookup_col])

        # VLOOKUPå®Ÿè¡Œï¼ˆpandasã®mergeæ©Ÿèƒ½ã‚’ä½¿ç”¨ï¼‰
        result = df1.merge(
            df2_filtered, 
            left_on=search_col, 
            right_on=lookup_col, 
            how="left"
        )

        # çµæœã®ç¢ºèªã¨è¡¨ç¤º
        matched_count = result[return_cols[0]].notna().sum()
        unmatched_count = len(result) - matched_count
        
        print(f"å‡¦ç†å®Œäº†!")
        print(f"ç·ãƒ‡ãƒ¼ã‚¿æ•°: {len(result)}è¡Œ")
        print(f"ãƒãƒƒãƒæˆåŠŸ: {matched_count}è¡Œ")
        print(f"ãƒãƒƒãƒå¤±æ•—: {unmatched_count}è¡Œ")

        # çµæœä¿å­˜
        output_path = self.save_result_to_same_directory(result, config["excel1_path"])
        
        return True

    except Exception as e:
        print(f"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        return False
```

**æ–°äººå‘ã‘PointğŸ’¡**
- pandasã®`merge`æ©Ÿèƒ½ã§VLOOKUPã‚’å®Ÿç¾
- ãƒ‡ãƒ¼ã‚¿å‹çµ±ä¸€ã§ãƒãƒƒãƒãƒ³ã‚°ç²¾åº¦å‘ä¸Š
- å‡¦ç†çµæœã®çµ±è¨ˆæƒ…å ±è¡¨ç¤º

### ã‚¹ãƒ†ãƒƒãƒ—5: ç°¡å˜å®Ÿè¡Œç”¨ã®é–¢æ•°

```python
def quick_sheet_vlookup(excel1_path, excel1_sheet, excel2_path, excel2_sheet, 
                       search_col, lookup_col, return_cols, auto_save_same_dir=True):
    """
    ç°¡å˜å®Ÿè¡Œç”¨ã®é–¢æ•°
    
    ä½¿ç”¨ä¾‹:
    quick_sheet_vlookup(
        excel1_path="æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿.xlsx",
        excel1_sheet="æ³¨æ–‡",
        excel2_path="å•†å“ãƒã‚¹ã‚¿.xlsx", 
        excel2_sheet="å•†å“",
        search_col="å•†å“ã‚³ãƒ¼ãƒ‰",
        lookup_col="å•†å“ã‚³ãƒ¼ãƒ‰", 
        return_cols=["å•†å“å", "ä¾¡æ ¼"],
        auto_save_same_dir=True
    )
    """
    tool = ExcelSheetVLOOKUP()
    
    config = {
        "excel1_path": excel1_path,
        "excel1_sheet": excel1_sheet,
        "excel2_path": excel2_path,
        "excel2_sheet": excel2_sheet,
        "search_col": search_col,
        "lookup_col": lookup_col,
        "return_cols": return_cols,
        "auto_save_same_dir": auto_save_same_dir
    }
    
    return tool.vlookup_with_sheets(config)
```

### å®Ÿéš›ã®ä½¿ç”¨ä¾‹

```python
# å®Ÿéš›ã®æ¥­å‹™ã§ã®ä½¿ç”¨ä¾‹
if __name__ == "__main__":
    # æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã«å•†å“æƒ…å ±ã‚’è¿½åŠ 
    quick_sheet_vlookup(
        excel1_path="æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿_20241201.xlsx",
        excel1_sheet="æ³¨æ–‡ãƒªã‚¹ãƒˆ",
        excel2_path="å•†å“ãƒã‚¹ã‚¿.xlsx",
        excel2_sheet="å•†å“æƒ…å ±",
        search_col="å•†å“ã‚³ãƒ¼ãƒ‰",
        lookup_col="å•†å“ã‚³ãƒ¼ãƒ‰",
        return_cols=["å•†å“å", "å˜ä¾¡", "ã‚«ãƒ†ã‚´ãƒª"]
    )
    
    # å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã«å–¶æ¥­æ‹…å½“è€…æƒ…å ±ã‚’è¿½åŠ 
    quick_sheet_vlookup(
        excel1_path="å£²ä¸Šå®Ÿç¸¾.xlsx",
        excel1_sheet="å£²ä¸Šãƒ‡ãƒ¼ã‚¿",
        excel2_path="å–¶æ¥­ãƒã‚¹ã‚¿.xlsx",
        excel2_sheet="å–¶æ¥­æ‹…å½“",
        search_col="å–¶æ¥­ID",
        lookup_col="å–¶æ¥­ID",
        return_cols=["å–¶æ¥­æ‹…å½“å", "éƒ¨ç½²", "ç›®æ¨™é‡‘é¡"]
    )
```

## VSCodeã®ä¾¿åˆ©æ©Ÿèƒ½

### 1. ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ã®æ´»ç”¨

**ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã®è¨­ç½®**
```python
def vlookup_with_sheets(self, config):
    print("=== Excel VLOOKUP å‡¦ç†é–‹å§‹ ===")
    
    # ã“ã“ã«ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¨­ç½®
    df1 = self.read_excel_sheet(config["excel1_path"], config["excel1_sheet"])
    
    # å¤‰æ•°ã®ä¸­èº«ã‚’ç¢ºèªã—ãªãŒã‚‰ãƒ‡ãƒãƒƒã‚°
    if df1 is None:
        return False
```

**VSCodeã§ã®ãƒ‡ãƒãƒƒã‚°æ‰‹é †ï¼š**
1. è¡Œç•ªå·ã®å·¦ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆè¨­ç½®
2. `F5`ã§ãƒ‡ãƒãƒƒã‚°é–‹å§‹
3. `F10`ã§ã‚¹ãƒ†ãƒƒãƒ—ã‚ªãƒ¼ãƒãƒ¼
4. `F11`ã§ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³
5. å¤‰æ•°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§å€¤ã‚’ç¢ºèª

### 2. ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆ

ã‚ˆãä½¿ã†ã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ãƒ‹ãƒšãƒƒãƒˆåŒ–ã—ã¾ã—ã‚‡ã†ï¼š

**settings.jsonï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šï¼‰**
```json
{
    "python.snippets": {
        "pandas_read": {
            "prefix": "pd_read",
            "body": [
                "try:",
                "    df = pd.read_excel('${1:file_path}', sheet_name='${2:sheet_name}')",
                "    print(f'èª­ã¿è¾¼ã¿å®Œäº†: {df.shape[0]}è¡Œ x {df.shape[1]}åˆ—')",
                "except Exception as e:",
                "    print(f'ã‚¨ãƒ©ãƒ¼: {e}')",
                "    df = None"
            ],
            "description": "pandas Excelèª­ã¿è¾¼ã¿"
        }
    }
}
```

### 3. Lintingï¼ˆã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ï¼‰

**settings.json**
```json
{
    "python.linting.enabled": true,
    "python.linting.pylintEnabled": true,
    "python.formatting.provider": "black",
    "python.formatting.blackArgs": ["--line-length=88"]
}
```

### 4. Gitçµ±åˆ

VSCodeã®Gitæ©Ÿèƒ½ã‚’æ´»ç”¨ï¼š
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Gitç®¡ç†
git init
git add .
git commit -m "åˆå›ã‚³ãƒŸãƒƒãƒˆ: Excel VLOOKUPãƒ„ãƒ¼ãƒ«ä½œæˆ"

# .gitignoreãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
echo "*.pyc" > .gitignore
echo "__pycache__/" >> .gitignore
echo "venv/" >> .gitignore
echo "*.xlsx" >> .gitignore  # ä½œæ¥­ãƒ•ã‚¡ã‚¤ãƒ«ã¯é™¤å¤–
```

## ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã®ãƒ’ãƒ³ãƒˆ

### 1. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„

```python
# æ‚ªã„ä¾‹
def read_file(path):
    return pd.read_excel(path)

# è‰¯ã„ä¾‹
def read_file(path):
    try:
        if not os.path.exists(path):
            raise FileNotFoundError(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {path}")
        
        df = pd.read_excel(path)
        
        if df.empty:
            raise ValueError("ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“")
            
        return df
        
    except FileNotFoundError as e:
        print(f"ãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼: {e}")
        return None
    except Exception as e:
        print(f"äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: {e}")
        return None
```

### 2. ãƒ­ã‚°æ©Ÿèƒ½ã®è¿½åŠ 

```python
import logging

# ãƒ­ã‚°è¨­å®š
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('vlookup_tool.log'),
        logging.StreamHandler()
    ]
)

logger = logging.getLogger(__name__)

def vlookup_with_sheets(self, config):
    logger.info("VLOOKUPå‡¦ç†é–‹å§‹")
    try:
        # å‡¦ç†å†…å®¹
        logger.info(f"å‡¦ç†å®Œäº†: {len(result)}è¡Œ")
        return True
    except Exception as e:
        logger.error(f"å‡¦ç†ã‚¨ãƒ©ãƒ¼: {e}")
        return False
```

### 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ´»ç”¨

**config.yaml**
```yaml
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
default:
  auto_save_same_dir: true
  include_summary: true
  
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰è¨­å®š
projects:
  sales_analysis:
    excel1_path: "å£²ä¸Šãƒ‡ãƒ¼ã‚¿.xlsx"
    excel1_sheet: "æœˆæ¬¡å£²ä¸Š"
    excel2_path: "ãƒã‚¹ã‚¿.xlsx"
    excel2_sheet: "å•†å“ãƒã‚¹ã‚¿"
    search_col: "å•†å“ã‚³ãƒ¼ãƒ‰"
    lookup_col: "å•†å“ã‚³ãƒ¼ãƒ‰"
    return_cols: ["å•†å“å", "ä¾¡æ ¼", "ã‚«ãƒ†ã‚´ãƒª"]
```

### 4. ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ä½œæˆ

```python
import unittest

class TestVLOOKUPTool(unittest.TestCase):
    def setUp(self):
        self.tool = ExcelSheetVLOOKUP()
    
    def test_file_exists(self):
        """ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ"""
        result = self.tool.read_excel_sheet("å­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«.xlsx", "Sheet1")
        self.assertIsNone(result)
    
    def test_vlookup_basic(self):
        """åŸºæœ¬çš„ãªVLOOKUPå‡¦ç†ã®ãƒ†ã‚¹ãƒˆ"""
        # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ
        # ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³
        pass

if __name__ == '__main__':
    unittest.main()
```

### 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

```python
import time
from functools import wraps

def timing_decorator(func):
    """å®Ÿè¡Œæ™‚é–“æ¸¬å®šãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿"""
    @wraps(func)
    def wrapper(*args, **kwargs):
        start = time.time()
        result = func(*args, **kwargs)
        end = time.time()
        print(f"{func.__name__} å®Ÿè¡Œæ™‚é–“: {end - start:.2f}ç§’")
        return result
    return wrapper

@timing_decorator
def vlookup_with_sheets(self, config):
    # VLOOKUPå‡¦ç†
    pass
```

## ã¾ã¨ã‚

### ğŸ¯ ä»Šå›å­¦ã‚“ã ã“ã¨
- VSCodeã§ã®Pythoné–‹ç™ºç’°å¢ƒæ§‹ç¯‰
- å®Ÿè·µçš„ãªExcelè‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã®ä½œæˆ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã®é‡è¦æ€§
- ãƒ‡ãƒãƒƒã‚°æŠ€è¡“ã¨ã‚³ãƒ¼ãƒ‰å“è³ªç®¡ç†

### ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
1. **GUIåŒ–**: Tkinter ã‚„ Streamlit ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ä½œæˆ
2. **WebåŒ–**: Flask ã‚„ FastAPI ã§Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŒ–
3. **ãƒãƒƒãƒå‡¦ç†**: ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼ã¨é€£æºã—ãŸè‡ªå‹•å®Ÿè¡Œ
4. **ã‚¯ãƒ©ã‚¦ãƒ‰åŒ–**: AWS Lambda ã‚„ Google Cloud Functions ã§ã®å®Ÿè¡Œ

### ğŸ’¡ å®Ÿå‹™ã§ã®æ´»ç”¨ã‚¢ã‚¤ãƒ‡ã‚¢
- æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ
- ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯ãƒ„ãƒ¼ãƒ«
- ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ä¸€æ‹¬å¤‰æ›
- ãƒ¡ãƒ¼ãƒ«é€ä¿¡è‡ªå‹•åŒ–
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºãƒ„ãƒ¼ãƒ«

### ğŸ“š ãŠã™ã™ã‚å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹
- **å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: pandas, openpyxl
- **æ›¸ç±**: ã€Œé€€å±ˆãªã“ã¨ã¯Pythonã«ã‚„ã‚‰ã›ã‚ˆã†ã€
- **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£**: Stack Overflow, Qiita
- **å®Ÿè·µ**: è‡ªåˆ†ã®æ¥­å‹™ã‹ã‚‰å°ã•ãªè‡ªå‹•åŒ–ã‚’å§‹ã‚ã‚‹

---

**Remember**: å®Œç’§ã‚’ç›®æŒ‡ã•ãšã€ã¾ãšã¯å‹•ãã‚‚ã®ã‚’ä½œã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚å°ã•ãªè‡ªå‹•åŒ–ã®ç©ã¿é‡ã­ãŒã€å¤§ããªä¾¡å€¤ã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚é ‘å¼µã£ã¦ï¼ ğŸ’ª

*ã“ã®è¨˜äº‹ãŒå½¹ã«ç«‹ã£ãŸã‚‰ã€ãœã²å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã—ã¦è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚è³ªå•ãŒã‚ã‚Œã°ã€ã„ã¤ã§ã‚‚ãŠæ°—è»½ã«ã©ã†ãï¼*
